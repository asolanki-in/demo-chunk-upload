#import <Foundation/Foundation.h>
#import <LocalAuthentication/LocalAuthentication.h>
#import <Security/Security.h>

NS_ASSUME_NONNULL_BEGIN

// Configuration flags
typedef NS_OPTIONS(NSUInteger, BypassOptions) {
    BypassOptionNone = 0,
    BypassOptionBiometrics = 1 << 0,
    BypassOptionKeychain = 1 << 1,
    BypassOptionAll = BypassOptionBiometrics | BypassOptionKeychain
};

@interface BiometricBypass : NSObject

// Singleton instance
+ (instancetype)shared;

// Configure bypass options
+ (void)configureWithOptions:(BypassOptions)options;

// Enable/disable bypass at runtime
+ (void)setEnabled:(BOOL)enabled;

// Check if bypass is active
+ (BOOL)isEnabled;

// Simulate biometric authentication
+ (BOOL)simulateBiometricSuccess:(BOOL)success;

// Keychain mocking
+ (void)mockKeychainItem:(NSDictionary *)item forQuery:(NSDictionary *)query;
+ (void)clearMockedKeychain;

@end

// Convenience macros for testing
#define BYPASS_BIOMETRICS [BiometricBypass configureWithOptions:BypassOptionBiometrics]
#define BYPASS_KEYCHAIN [BiometricBypass configureWithOptions:BypassOptionKeychain]
#define BYPASS_ALL [BiometricBypass configureWithOptions:BypassOptionAll]
#define DISABLE_BYPASS [BiometricBypass setEnabled:NO]

NS_ASSUME_NONNULL_END
