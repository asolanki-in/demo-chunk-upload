#import <Foundation/Foundation.h>
#import <Security/Security.h>

NS_ASSUME_NONNULL_BEGIN

@interface SecureEnclaveMock : NSObject

@property (nonatomic, assign) BOOL simulateSuccess;

+ (instancetype)shared;

// Item management
- (void)addItem:(NSDictionary *)attributes withIdentifier:(NSString *)identifier;
- (nullable id)copyMatching:(NSDictionary *)query;
- (BOOL)updateItemWithQuery:(NSDictionary *)query attributes:(NSDictionary *)attributes;
- (BOOL)deleteItemWithQuery:(NSDictionary *)query;

// Mock management
- (void)mockItem:(NSDictionary *)item forQuery:(NSDictionary *)query;
- (void)clearAllItems;

// Query helpers
- (NSArray *)findItemsMatchingQuery:(NSDictionary *)query;
- (BOOL)item:(NSDictionary *)item matchesQuery:(NSDictionary *)query;

@end

NS_ASSUME_NONNULL_END
